
        #include <petsc.h>
        #include <stdbool.h>
        #include <math.h>
        
        


        
            #include <immintrin.h>

            
            // This code is generated visiting a COFFEE AST

#include "firedrake_geometry.h"


static inline void form_cell_integral_0_otherwise (double A[20][20] , double** coordinate_dofs )
{
  // This code is generated visiting a COFFEE AST
  
  // Compute Jacobian
  double J[9];
  compute_jacobian_tetrahedron_3d(J, coordinate_dofs);
  
  // Compute Jacobian inverse and determinant
  double K[9];
  double detJ;
  compute_jacobian_inverse_tetrahedron_3d(K, detJ, J);
  
  const double det = fabs(detJ);
  
  // Compute cell volume
  
  
  // Compute circumradius
  
  
  static const double W24[24]  = {0.00665379170969465, 0.00665379170969465, 0.00665379170969465, 0.00665379170969465, 0.00167953517588678, 0.00167953517588678, 0.00167953517588678, 0.00167953517588678, 0.0092261969239424, 0.0092261969239424, 0.0092261969239424, 0.0092261969239424, 0.00803571428571428, 0.00803571428571428, 0.00803571428571428, 0.00803571428571428, 0.00803571428571428, 0.00803571428571428, 0.00803571428571428, 0.00803571428571428, 0.00803571428571428, 0.00803571428571428, 0.00803571428571428, 0.00803571428571428};
  static const double FE0[24][20]  = {{0.0518334274205328, -0.0113752824165089, 0.0518334274205326, 0.0518334274205328, -0.0738188003418083, -0.0738188003418085, 0.0235880447339438, -0.122522222879685, 0.0235880447339437, -0.122522222879685, -0.0738188003418087, -0.0738188003418086, -0.0738188003418084, -0.0738188003418084, -0.122522222879685, 0.0235880447339437, 0.442912802050851, 0.266851930490431, 0.442912802050851, 0.442912802050851}, 
  {-0.0113752824165089, 0.0518334274205327, 0.0518334274205326, 0.0518334274205328, -0.0738188003418084, -0.0738188003418085, -0.0738188003418083, -0.0738188003418085, -0.0738188003418085, -0.0738188003418085, 0.0235880447339435, -0.122522222879685, 0.0235880447339438, -0.122522222879685, 0.0235880447339437, -0.122522222879685, 0.266851930490431, 0.442912802050851, 0.442912802050851, 0.442912802050851}, 
  {0.0518334274205328, 0.0518334274205327, 0.0518334274205326, -0.0113752824165089, -0.122522222879684, 0.0235880447339437, -0.122522222879684, 0.0235880447339437, -0.0738188003418085, -0.0738188003418085, -0.122522222879685, 0.0235880447339436, -0.0738188003418084, -0.0738188003418084, -0.0738188003418086, -0.0738188003418086, 0.442912802050851, 0.442912802050851, 0.442912802050851, 0.266851930490431}, 
  {0.0518334274205328, 0.0518334274205327, -0.0113752824165091, 0.0518334274205328, 0.0235880447339438, -0.122522222879685, -0.0738188003418083, -0.0738188003418086, -0.122522222879685, 0.0235880447339437, -0.0738188003418086, -0.0738188003418086, -0.122522222879684, 0.0235880447339438, -0.0738188003418086, -0.0738188003418086, 0.442912802050851, 0.442912802050851, 0.266851930490431, 0.442912802050851}, 
  {0.0335320936324425, 0.454708014971024, 0.0335320936324424, 0.0335320936324424, -0.00653625658062919, -0.00653625658062907, 0.262571303208207, -0.141090036475047, 0.262571303208207, -0.141090036475047, -0.00653625658062941, -0.0065362565806291, -0.00653625658062919, -0.00653625658062902, -0.141090036475048, 0.262571303208208, 0.039217539483775, 0.00181682496461916, 0.039217539483775, 0.0392175394837749}, 
  {0.454708014971024, 0.0335320936324424, 0.0335320936324424, 0.0335320936324424, -0.00653625658062914, -0.00653625658062907, -0.00653625658062913, -0.00653625658062899, -0.00653625658062925, -0.00653625658062898, 0.262571303208207, -0.141090036475047, 0.262571303208207, -0.141090036475047, 0.262571303208207, -0.141090036475047, 0.0018168249646192, 0.0392175394837748, 0.0392175394837748, 0.0392175394837747}, 
  {0.0335320936324425, 0.0335320936324424, 0.0335320936324424, 0.454708014971024, -0.141090036475047, 0.262571303208207, -0.141090036475047, 0.262571303208207, -0.00653625658062916, -0.00653625658062911, -0.141090036475048, 0.262571303208207, -0.00653625658062898, -0.00653625658062911, -0.00653625658062925, -0.00653625658062909, 0.0392175394837749, 0.0392175394837747, 0.039217539483775, 0.00181682496461918}, 
  {0.0335320936324426, 0.0335320936324423, 0.454708014971024, 0.0335320936324424, 0.262571303208207, -0.141090036475047, -0.00653625658062913, -0.00653625658062915, -0.141090036475047, 0.262571303208207, -0.00653625658062938, -0.00653625658062917, -0.141090036475048, 0.262571303208208, -0.00653625658062924, -0.00653625658062917, 0.0392175394837751, 0.0392175394837749, 0.00181682496461907, 0.039217539483775}, 
  {0.00549173953599326, 0.0282514044564419, 0.00549173953599298, 0.00549173953599316, -0.0154230130264835, -0.0154230130264835, -0.0431124223349633, -0.00157830837224368, -0.0431124223349636, -0.00157830837224369, -0.0154230130264841, -0.0154230130264837, -0.0154230130264837, -0.0154230130264834, -0.00157830837224382, -0.0431124223349635, 0.0925380781589021, 0.904269412739396, 0.092538078158902, 0.0925380781589019}, 
  {0.0282514044564417, 0.00549173953599304, 0.00549173953599299, 0.0054917395359931, -0.0154230130264833, -0.0154230130264836, -0.0154230130264833, -0.0154230130264836, -0.0154230130264835, -0.0154230130264835, -0.0431124223349633, -0.0015783083722437, -0.043112422334963, -0.00157830837224357, -0.0431124223349634, -0.00157830837224367, 0.904269412739397, 0.092538078158901, 0.0925380781589013, 0.0925380781589012}, 
  {0.00549173953599328, 0.00549173953599307, 0.00549173953599304, 0.0282514044564419, -0.00157830837224367, -0.0431124223349634, -0.00157830837224367, -0.0431124223349635, -0.0154230130264835, -0.0154230130264836, -0.00157830837224401, -0.0431124223349635, -0.0154230130264838, -0.0154230130264835, -0.0154230130264839, -0.0154230130264835, 0.0925380781589022, 0.0925380781589017, 0.092538078158902, 0.904269412739396}, 
  {0.00549173953599331, 0.00549173953599308, 0.0282514044564418, 0.00549173953599314, -0.0431124223349633, -0.00157830837224373, -0.0154230130264834, -0.0154230130264836, -0.00157830837224379, -0.0431124223349634, -0.0154230130264841, -0.0154230130264837, -0.00157830837224378, -0.0431124223349633, -0.015423013026484, -0.0154230130264836, 0.092538078158902, 0.0925380781589016, 0.904269412739397, 0.0925380781589018}, 
  {-0.0465847495312456, 0.0306694990624912, 0.0465847495312456, 0.0465847495312456, -0.0147542485937368, -0.0147542485937369, -0.0147542485937367, -0.0625, -0.0147542485937368, -0.0625, 0.139754248593737, -0.139754248593737, 0.139754248593737, -0.139754248593737, 0.592008497187474, -0.139754248593737, 0.0295084971874738, 0.0659830056250525, 0.279508497187474, 0.279508497187474}, 
  {-0.0465847495312457, 0.0465847495312456, 0.0306694990624912, 0.0465847495312456, -0.0147542485937368, -0.0625, -0.0147542485937367, -0.0147542485937369, -0.0625000000000001, -0.0147542485937368, 0.139754248593737, -0.139754248593737, 0.592008497187474, -0.139754248593737, 0.139754248593737, -0.139754248593737, 0.0295084971874738, 0.279508497187474, 0.0659830056250527, 0.279508497187474}, 
  {-0.0465847495312455, 0.0465847495312456, 0.0465847495312456, 0.0306694990624912, -0.0624999999999999, -0.0147542485937368, -0.0624999999999998, -0.0147542485937367, -0.0147542485937369, -0.0147542485937368, 0.592008497187474, -0.139754248593737, 0.139754248593737, -0.139754248593737, 0.139754248593737, -0.139754248593737, 0.0295084971874738, 0.279508497187474, 0.279508497187474, 0.0659830056250526}, 
  {0.0306694990624911, -0.0465847495312457, 0.0465847495312456, 0.0465847495312456, -0.0147542485937368, -0.0147542485937369, 0.139754248593737, -0.139754248593737, 0.139754248593737, -0.139754248593737, -0.0147542485937371, -0.0625, -0.0147542485937368, -0.0625, -0.139754248593737, 0.592008497187474, 0.0659830056250526, 0.0295084971874737, 0.279508497187474, 0.279508497187474}, 
  {0.0306694990624912, 0.0465847495312455, -0.0465847495312458, 0.0465847495312456, 0.139754248593737, -0.139754248593737, -0.0147542485937368, -0.0147542485937369, -0.139754248593737, 0.139754248593737, -0.014754248593737, -0.0625000000000001, -0.139754248593737, 0.592008497187474, -0.0147542485937369, -0.0625000000000001, 0.0659830056250528, 0.279508497187474, 0.0295084971874738, 0.279508497187474}, 
  {0.0306694990624913, 0.0465847495312455, 0.0465847495312456, -0.0465847495312458, -0.139754248593737, 0.139754248593737, -0.139754248593737, 0.139754248593737, -0.0147542485937369, -0.0147542485937368, -0.139754248593737, 0.592008497187474, -0.0147542485937367, -0.0624999999999999, -0.0147542485937369, -0.0624999999999999, 0.0659830056250526, 0.279508497187473, 0.279508497187474, 0.0295084971874736}, 
  {0.0465847495312456, 0.0465847495312456, 0.0306694990624912, -0.0465847495312456, -0.139754248593737, 0.592008497187474, -0.139754248593737, 0.139754248593737, -0.0625000000000001, -0.0147542485937367, -0.139754248593737, 0.139754248593737, -0.0624999999999999, -0.0147542485937367, -0.0147542485937369, -0.0147542485937368, 0.279508497187474, 0.279508497187474, 0.0659830056250526, 0.0295084971874736}, 
  {0.0465847495312457, 0.030669499062491, -0.0465847495312458, 0.0465847495312456, 0.139754248593737, -0.139754248593737, -0.0147542485937368, -0.0625000000000001, -0.139754248593737, 0.592008497187474, -0.014754248593737, -0.0147542485937369, -0.139754248593737, 0.139754248593737, -0.0625000000000002, -0.0147542485937369, 0.279508497187474, 0.0659830056250524, 0.0295084971874737, 0.279508497187474}, 
  {0.0465847495312457, -0.0465847495312458, 0.0465847495312456, 0.0306694990624912, -0.0624999999999999, -0.0147542485937368, 0.592008497187473, -0.139754248593737, 0.139754248593737, -0.139754248593737, -0.0625000000000002, -0.0147542485937368, -0.0147542485937368, -0.0147542485937368, -0.139754248593737, 0.139754248593737, 0.279508497187474, 0.0295084971874736, 0.279508497187474, 0.0659830056250526}, 
  {0.0465847495312457, 0.0465847495312455, -0.0465847495312459, 0.0306694990624912, 0.592008497187474, -0.139754248593737, -0.0624999999999998, -0.0147542485937369, -0.139754248593737, 0.139754248593737, -0.0625000000000002, -0.0147542485937369, -0.139754248593737, 0.139754248593737, -0.0147542485937369, -0.0147542485937368, 0.279508497187474, 0.279508497187474, 0.0295084971874738, 0.0659830056250525}, 
  {0.0465847495312456, 0.0306694990624912, 0.0465847495312456, -0.0465847495312456, -0.139754248593737, 0.139754248593737, -0.139754248593737, 0.592008497187474, -0.0147542485937369, -0.0625, -0.139754248593737, 0.139754248593737, -0.0147542485937367, -0.0147542485937368, -0.0625000000000002, -0.0147542485937368, 0.279508497187474, 0.0659830056250523, 0.279508497187474, 0.0295084971874736}, 
  {0.0465847495312457, -0.0465847495312458, 0.0306694990624911, 0.0465847495312456, -0.0147542485937368, -0.0625, 0.139754248593737, -0.139754248593737, 0.592008497187474, -0.139754248593737, -0.0147542485937371, -0.0147542485937369, -0.0624999999999999, -0.0147542485937368, -0.139754248593737, 0.139754248593737, 0.279508497187474, 0.0295084971874738, 0.0659830056250526, 0.279508497187474}};
  
  
  for (int ip  = 0; ip < 24; ip += 1)
  {
    double Z[1];
    Z[0] = W24[ip]*det;
    
    for (int j  = 0; j < 20; j += 1)
    {
      
      for (int k  = 0; k < 20; k += 1)
      {
        A[j][k] += (Z[0] * FE0[ip][k] * FE0[ip][j]);
        
      }
      
    }
    
  }
  
}
            

        
        void wrap_form_cell_integral_0_otherwise(int start, int end,
                      Mat arg0_0_, int *arg0_0_map0_0, int *arg0_0_map1_0, double *arg1_0, int *arg1_0_map0_0
                      ) {
  Mat arg0_0_0 = arg0_0_;
  double *arg1_0_vec[12];
  for ( int n = start; n < end; n++ ) {
    int i = n;
    arg1_0_vec[0] = arg1_0 + (arg1_0_map0_0[i * 4 + 0])* 3;
    arg1_0_vec[1] = arg1_0 + (arg1_0_map0_0[i * 4 + 1])* 3;
    arg1_0_vec[2] = arg1_0 + (arg1_0_map0_0[i * 4 + 2])* 3;
    arg1_0_vec[3] = arg1_0 + (arg1_0_map0_0[i * 4 + 3])* 3;
    arg1_0_vec[4] = arg1_0 + (arg1_0_map0_0[i * 4 + 0])* 3 + 1;
    arg1_0_vec[5] = arg1_0 + (arg1_0_map0_0[i * 4 + 1])* 3 + 1;
    arg1_0_vec[6] = arg1_0 + (arg1_0_map0_0[i * 4 + 2])* 3 + 1;
    arg1_0_vec[7] = arg1_0 + (arg1_0_map0_0[i * 4 + 3])* 3 + 1;
    arg1_0_vec[8] = arg1_0 + (arg1_0_map0_0[i * 4 + 0])* 3 + 2;
    arg1_0_vec[9] = arg1_0 + (arg1_0_map0_0[i * 4 + 1])* 3 + 2;
    arg1_0_vec[10] = arg1_0 + (arg1_0_map0_0[i * 4 + 2])* 3 + 2;
    arg1_0_vec[11] = arg1_0 + (arg1_0_map0_0[i * 4 + 3])* 3 + 2;
    double buffer_arg0_0[20][20] __attribute__((aligned(32))) = {{0.0}};
    form_cell_integral_0_otherwise(buffer_arg0_0, arg1_0_vec);
    MatSetValuesLocal(arg0_0_0, 20, arg0_0_map0_0 + i * 20,
                                             20, arg0_0_map1_0 + i * 20,
                                             (const PetscScalar *)buffer_arg0_0,
                                             ADD_VALUES);;
  }
}
        
        