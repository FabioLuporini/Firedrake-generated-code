
        #include <petsc.h>
        #include <stdbool.h>
        #include <math.h>
        
        


        
            #include <immintrin.h>

            
            // This code is generated visiting a COFFEE AST

#include "firedrake_geometry.h"


void form_cell_integral_0_otherwise(double A[4][4], double *coordinate_dofs, double **w0, double **w1)
{
// Section for quadrature weights and points
static const double weights15[15] = { 0.0302836780971, 0.00602678571429, 0.00602678571429, 0.00602678571429, 0.00602678571429, 0.011645249086, 0.011645249086, 0.011645249086, 0.011645249086, 0.0109491415614, 0.0109491415614, 0.0109491415614, 0.0109491415614, 0.0109491415614, 0.0109491415614 };
static const double points15[45] = { 0.25, 0.25, 0.25, 0.0, 0.333333333333, 0.333333333333, 0.333333333333, 0.333333333333, 0.333333333333, 0.333333333333, 0.333333333333, 0.0, 0.333333333333, 0.0, 0.333333333333, 0.727272727273, 0.0909090909091, 0.0909090909091, 0.0909090909091, 0.0909090909091, 0.0909090909091, 0.0909090909091, 0.0909090909091, 0.727272727273, 0.0909090909091, 0.727272727273, 0.0909090909091, 0.433449846426, 0.0665501535737, 0.0665501535737, 0.0665501535737, 0.433449846426, 0.0665501535737, 0.0665501535737, 0.0665501535737, 0.433449846426, 0.0665501535737, 0.433449846426, 0.433449846426, 0.433449846426, 0.0665501535737, 0.433449846426, 0.433449846426, 0.433449846426, 0.0665501535737 };
// Section for precomputed element basis function values
// Table dimensions: num_entities, num_points, num_dofs
// Definitions of 4 tables for 15 quadrature points
static const double FE0_C0_Q15[1][15][4] =
    { { { 0.25, 0.25, 0.25, 0.25 },
        { 0.333333333333, -3.12250225676e-17, 0.333333333333, 0.333333333333 },
        { 9.71445146547e-17, 0.333333333333, 0.333333333333, 0.333333333333 },
        { 0.333333333333, 0.333333333333, 0.333333333333, 0.0 },
        { 0.333333333333, 0.333333333333, -4.16333634234e-17, 0.333333333333 },
        { 0.0909090909091, 0.727272727273, 0.0909090909091, 0.0909090909091 },
        { 0.727272727273, 0.0909090909091, 0.0909090909091, 0.0909090909091 },
        { 0.0909090909091, 0.0909090909091, 0.0909090909091, 0.727272727273 },
        { 0.0909090909091, 0.0909090909091, 0.727272727273, 0.0909090909091 },
        { 0.433449846426, 0.433449846426, 0.0665501535737, 0.0665501535737 },
        { 0.433449846426, 0.0665501535737, 0.433449846426, 0.0665501535737 },
        { 0.433449846426, 0.0665501535737, 0.0665501535737, 0.433449846426 },
        { 0.0665501535737, 0.0665501535737, 0.433449846426, 0.433449846426 },
        { 0.0665501535737, 0.433449846426, 0.0665501535737, 0.433449846426 },
        { 0.0665501535737, 0.433449846426, 0.433449846426, 0.0665501535737 } } };
static const double FE1_C0_D001_Q15[1][15][4] =
    { { { -1.0, -5.55111512313e-17, 0.0, 1.0 },
        { -1.0, -5.55111512313e-17, 0.0, 1.0 },
        { -1.0, -5.55111512313e-17, 0.0, 1.0 },
        { -1.0, 1.11022302463e-16, 5.55111512313e-17, 1.0 },
        { -1.0, -5.55111512313e-17, 0.0, 1.0 },
        { -1.0, 1.11022302463e-16, 5.55111512313e-17, 1.0 },
        { -1.0, 1.11022302463e-16, 5.55111512313e-17, 1.0 },
        { -1.0, -2.77555756156e-16, -1.11022302463e-16, 1.0 },
        { -1.0, 1.66533453694e-16, 1.66533453694e-16, 1.0 },
        { -1.0, 1.11022302463e-16, 5.55111512313e-17, 1.0 },
        { -1.0, 1.11022302463e-16, 5.55111512313e-17, 1.0 },
        { -1.0, -1.66533453694e-16, -5.55111512313e-17, 1.0 },
        { -1.0, -1.66533453694e-16, -5.55111512313e-17, 1.0 },
        { -1.0, -1.66533453694e-16, -5.55111512313e-17, 1.0 },
        { -1.0, 1.11022302463e-16, 5.55111512313e-17, 1.0 } } };
static const double FE1_C0_D010_Q15[1][15][3] =
    { { { -1.0, -1.11022302463e-16, 1.0 },
        { -1.0, -1.11022302463e-16, 1.0 },
        { -1.0, -1.11022302463e-16, 1.0 },
        { -1.0, -5.55111512313e-17, 1.0 },
        { -1.0, -1.11022302463e-16, 1.0 },
        { -1.0, -1.11022302463e-16, 1.0 },
        { -1.0, -1.11022302463e-16, 1.0 },
        { -1.0, -2.77555756156e-16, 1.0 },
        { -1.0, 0.0, 1.0 },
        { -1.0, -5.55111512313e-17, 1.0 },
        { -1.0, -5.55111512313e-17, 1.0 },
        { -1.0, -1.66533453694e-16, 1.0 },
        { -1.0, -1.66533453694e-16, 1.0 },
        { -1.0, -1.66533453694e-16, 1.0 },
        { -1.0, -5.55111512313e-17, 1.0 } } };
static const double FE1_C0_D100_Q15[1][15][2] =
    { { { -1.0, 1.0 },
        { -1.0, 1.0 },
        { -1.0, 1.0 },
        { -1.0, 1.0 },
        { -1.0, 1.0 },
        { -1.0, 1.0 },
        { -1.0, 1.0 },
        { -1.0, 1.0 },
        { -1.0, 1.0 },
        { -1.0, 1.0 },
        { -1.0, 1.0 },
        { -1.0, 1.0 },
        { -1.0, 1.0 },
        { -1.0, 1.0 },
        { -1.0, 1.0 } } };
// Section for piecewise constant computations
const double J_c0 = coordinate_dofs[0] * FE1_C0_D100_Q15[0][0][0 - 0] + coordinate_dofs[3] * FE1_C0_D100_Q15[0][0][1 - 0];
const double J_c4 = coordinate_dofs[1] * FE1_C0_D010_Q15[0][0][4 - 4] + coordinate_dofs[4] * FE1_C0_D010_Q15[0][0][5 - 4] + coordinate_dofs[7] * FE1_C0_D010_Q15[0][0][6 - 4];
const double J_c8 = coordinate_dofs[2] * FE1_C0_D001_Q15[0][0][8 - 8] + coordinate_dofs[5] * FE1_C0_D001_Q15[0][0][9 - 8] + coordinate_dofs[8] * FE1_C0_D001_Q15[0][0][10 - 8] + coordinate_dofs[11] * FE1_C0_D001_Q15[0][0][11 - 8];
const double J_c5 = coordinate_dofs[1] * FE1_C0_D001_Q15[0][0][4 - 4] + coordinate_dofs[4] * FE1_C0_D001_Q15[0][0][5 - 4] + coordinate_dofs[7] * FE1_C0_D001_Q15[0][0][6 - 4] + coordinate_dofs[10] * FE1_C0_D001_Q15[0][0][7 - 4];
const double J_c7 = coordinate_dofs[2] * FE1_C0_D010_Q15[0][0][8 - 8] + coordinate_dofs[5] * FE1_C0_D010_Q15[0][0][9 - 8] + coordinate_dofs[8] * FE1_C0_D010_Q15[0][0][10 - 8];
const double J_c1 = coordinate_dofs[0] * FE1_C0_D010_Q15[0][0][0 - 0] + coordinate_dofs[3] * FE1_C0_D010_Q15[0][0][1 - 0] + coordinate_dofs[6] * FE1_C0_D010_Q15[0][0][2 - 0];
const double J_c6 = coordinate_dofs[2] * FE1_C0_D100_Q15[0][0][8 - 8] + coordinate_dofs[5] * FE1_C0_D100_Q15[0][0][9 - 8];
const double J_c3 = coordinate_dofs[1] * FE1_C0_D100_Q15[0][0][4 - 4] + coordinate_dofs[4] * FE1_C0_D100_Q15[0][0][5 - 4];
const double J_c2 = coordinate_dofs[0] * FE1_C0_D001_Q15[0][0][0 - 0] + coordinate_dofs[3] * FE1_C0_D001_Q15[0][0][1 - 0] + coordinate_dofs[6] * FE1_C0_D001_Q15[0][0][2 - 0] + coordinate_dofs[9] * FE1_C0_D001_Q15[0][0][3 - 0];
double sp15[18];
sp15[0] = J_c4 * J_c8;
sp15[1] = J_c5 * J_c7;
sp15[2] = -1 * sp15[1];
sp15[3] = sp15[0] + sp15[2];
sp15[4] = J_c0 * sp15[3];
sp15[5] = J_c5 * J_c6;
sp15[6] = J_c3 * J_c8;
sp15[7] = -1 * sp15[6];
sp15[8] = sp15[5] + sp15[7];
sp15[9] = J_c1 * sp15[8];
sp15[10] = sp15[4] + sp15[9];
sp15[11] = J_c3 * J_c7;
sp15[12] = J_c4 * J_c6;
sp15[13] = -1 * sp15[12];
sp15[14] = sp15[11] + sp15[13];
sp15[15] = J_c2 * sp15[14];
sp15[16] = sp15[10] + sp15[15];
sp15[17] = fabs(sp15[16]);
for (int iq = 0; iq < 15; ++iq)
{
    // Quadrature loop body setup (num_points=15)
    // Section for geometrically varying computations
    double w_0 = 0.0;
    for (int ic = 0; ic < 4; ++ic)
    {
        w_0 += w0[0][ic] * FE0_C0_Q15[0][iq][ic - 0];
    }
    double w_1 = 0.0;
    for (int ic = 0; ic < 4; ++ic)
    {
        w_1 += w1[0][ic] * FE0_C0_Q15[0][iq][ic - 0];
    }
    double sv15[3];
    sv15[0] = w_0 * w_1;
    sv15[1] = weights15[iq] * sp15[17];
    sv15[2] = sv15[1] * sv15[0];
    for (int ia0 = 0; ia0 < 4; ++ia0)
    {
        for (int ia1 = 0; ia1 < 4; ++ia1)
        {
            A[ia0][ia1] += sv15[2] * FE0_C0_Q15[0][iq][ia0 - 0] * FE0_C0_Q15[0][iq][ia1 - 0];
        }
    }
}
}

            

        
        void wrap_form_cell_integral_0_otherwise(int start, int end,
                      Mat arg0_0_, int *arg0_0_map0_0, int *arg0_0_map1_0, double *arg1_0, int *arg1_0_map0_0, double *arg2_0, int *arg2_0_map0_0, double *arg3_0, int *arg3_0_map0_0
                      ) {
  Mat arg0_0_0 = arg0_0_;
  double *arg1_0_vec[12];
    double *arg2_0_vec[4];
    double *arg3_0_vec[4];
  for ( int n = start; n < end; n++ ) {
    int i = n;
    arg1_0_vec[0] = arg1_0 + (arg1_0_map0_0[i * 4 + 0])* 3;
    arg1_0_vec[1] = arg1_0 + (arg1_0_map0_0[i * 4 + 1])* 3;
    arg1_0_vec[2] = arg1_0 + (arg1_0_map0_0[i * 4 + 2])* 3;
    arg1_0_vec[3] = arg1_0 + (arg1_0_map0_0[i * 4 + 3])* 3;
    arg1_0_vec[4] = arg1_0 + (arg1_0_map0_0[i * 4 + 0])* 3 + 1;
    arg1_0_vec[5] = arg1_0 + (arg1_0_map0_0[i * 4 + 1])* 3 + 1;
    arg1_0_vec[6] = arg1_0 + (arg1_0_map0_0[i * 4 + 2])* 3 + 1;
    arg1_0_vec[7] = arg1_0 + (arg1_0_map0_0[i * 4 + 3])* 3 + 1;
    arg1_0_vec[8] = arg1_0 + (arg1_0_map0_0[i * 4 + 0])* 3 + 2;
    arg1_0_vec[9] = arg1_0 + (arg1_0_map0_0[i * 4 + 1])* 3 + 2;
    arg1_0_vec[10] = arg1_0 + (arg1_0_map0_0[i * 4 + 2])* 3 + 2;
    arg1_0_vec[11] = arg1_0 + (arg1_0_map0_0[i * 4 + 3])* 3 + 2;
    arg2_0_vec[0] = arg2_0 + (arg2_0_map0_0[i * 4 + 0])* 1;
    arg2_0_vec[1] = arg2_0 + (arg2_0_map0_0[i * 4 + 1])* 1;
    arg2_0_vec[2] = arg2_0 + (arg2_0_map0_0[i * 4 + 2])* 1;
    arg2_0_vec[3] = arg2_0 + (arg2_0_map0_0[i * 4 + 3])* 1;
    arg3_0_vec[0] = arg3_0 + (arg3_0_map0_0[i * 4 + 0])* 1;
    arg3_0_vec[1] = arg3_0 + (arg3_0_map0_0[i * 4 + 1])* 1;
    arg3_0_vec[2] = arg3_0 + (arg3_0_map0_0[i * 4 + 2])* 1;
    arg3_0_vec[3] = arg3_0 + (arg3_0_map0_0[i * 4 + 3])* 1;
    double buffer_arg0_0[4][4] __attribute__((aligned(32))) = {{0.0}};
    form_cell_integral_0_otherwise(buffer_arg0_0, arg1_0_vec, arg2_0_vec, arg3_0_vec);
    MatSetValuesLocal(arg0_0_0, 4, arg0_0_map0_0 + i * 4,
                                             4, arg0_0_map1_0 + i * 4,
                                             (const PetscScalar *)buffer_arg0_0,
                                             ADD_VALUES);;
  }
}
        
        